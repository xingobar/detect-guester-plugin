module.exports.detect = (function() {
	var g = (positionY = newPositionX = newPositionY = 0),
		e = null,
		d = function(b) {
			b.off('mouseup');
			b.off('mousemove');
			b.off('touchstart');
			b.off('touchmove');
			g = positionY = newPositionX = newPositionY = 0;
			e = null;
		},
		f = function() {
			if (e)
				if (e.hasOwnProperty('callback'))
					if ('function' === typeof e.callback)
						try {
							e.callback();
						} catch (b) {
							throw Error(b.message);
						}
					else throw Error('param callback must be function');
				else throw Error('not set callback function');
		};
	return {
		swipe: function(b) {
			e = b;
			if (b.hasOwnProperty('target'))
				if ('string' === typeof b.target) {
					var c = $(b.target);
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						g = a.clientX;
						positionY = a.clientY;
						c.on('mouseup touchend', function(b) {
							b.preventDefault();
							d(c);
						});
						c.on('mousemove touchmove', function(a) {
							a.preventDefault();
							newPositionX = g - a.clientX;
							newPositionY = positionY - a.clientY;
							a = Math.abs(newPositionX);
							var h = Math.abs(newPositionY);
							if (b.hasOwnProperty('direction'))
								if ('string' === typeof b.direction)
									switch (b.direction) {
										case 'left':
											0 < newPositionX && 100 <= a && (f(), d(c));
											break;
										case 'right':
											0 > newPositionX && 100 <= a && (f(), d(c));
											break;
										case 'top':
											0 < newPositionY && 100 <= h && (f(), d(c));
											break;
										case 'down':
											0 > newPositionY && 100 <= h && (f(), d(c));
									}
								else throw Error('params direction must be string');
							else throw Error('must be set direction params');
						});
					});
				} else throw Error('param target element must be string');
			else throw Error('no set target element');
		},
		press: function(b) {
			e = b;
			if (b.hasOwnProperty('target'))
				if ('string' === typeof b.target) {
					var c = $(b.target);
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						f();
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							d(c);
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		longPress: function(b) {
			e = b;
			if (b.hasOwnProperty('target'))
				if ('string' === typeof b.target) {
					var c = $(b.target),
						a = 1500;
					if (b.hasOwnProperty('wait_time'))
						if ('integer' === typeof b.wait_time) a = b.wait_time;
						else throw Error('param wait time must be integer');
					c.on('mousedown touchstart', function(b) {
						b.preventDefault();
						setTimeout(function() {
							f();
						}, a);
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							d(c);
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		rotate: function(b) {
			e = b;
			if (e.hasOwnProperty('target'))
				if ('string' === typeof e.target) {
					var c = $(e.target);
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						g = a.clientX;
						positionY = a.clientY;
						if (a.touches instanceof Array && 2 < a.touches.length) {
							var b = a.touches[0].clientY;
							g = a.touches[0].clientX;
							positionY = b;
						}
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							d(c);
						});
						c.on('mousemove touchmove', function(a) {
							a.preventDefault();
							newPositionX = a.clientX;
							newPositionY = a.clientY;
							if (a.touches instanceof Array && 2 < a.touches.length) {
								var b = a.touches[0].clientY;
								newPositionX = a.touches[0].clientX;
								newPositionY = b;
							}
							a = 180 * Math.atan2(newPositionY - positionY, newPositionX - g) / Math.PI;
							20 >= a && -20 <= a
								? (f(), d(c))
								: 110 >= a && 70 <= a ? (f(), d(c)) : 90 < a && 180 > a && (f(), d(c));
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		zoom: function(b) {
			e = b;
			if (e.hasOwnProperty('target'))
				if ('string' === typeof e.target) {
					var c = $(e.target),
						a = [],
						d = 0;
					c.on('pointerdown', function(b) {
						a.push(b);
						2 === a.length && (d = Math.abs(a[0].clientX - a[1].clientX));
					});
					c.on('pointermove', function(b) {
						2 === a.length &&
							((b = Math.abs(a[0].clientX - a[1].clientX)),
							0 < d && (b > d ? alert('zoom in') : alert('zoom out')));
					});
					c.on('pointerup', function(b) {
						for (var d = 0; d < a.length; d++)
							if (a[d].pointerId == b.pointerId) {
								a.splice(d, 1);
								break;
							}
						0 == a.length &&
							(c.off('pointerup'),
							c.off('pointermove'),
							(g = positionY = newPositionX = newPositionY = 0),
							(e = null));
					});
				} else throw Error('param target element must be string');
			else throw Error('no set target element');
		}
	};
})();
