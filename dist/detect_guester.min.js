module.exports.detect = (function() {
	var h = (positionY = newPositionX = newPositionY = 0),
		b = null,
		k = function(a) {
			a.off('pointerup');
			a.off('pointermove');
		},
		e = function(a) {
			a.off('mouseup');
			a.off('mousemove');
			a.off('touchstart');
			a.off('touchmove');
			h = positionY = newPositionX = newPositionY = 0;
			b = null;
		},
		f = function() {
			if (b)
				if (b.hasOwnProperty('callback'))
					if ('function' === typeof b.callback)
						try {
							b.callback();
						} catch (a) {
							throw Error(a.message);
						}
					else throw Error('param callback must be function');
				else throw Error('not set callback function');
		};
	return {
		swipe: function(a) {
			b = a;
			if (a.hasOwnProperty('target'))
				if ('string' === typeof a.target) {
					var c = $(a.target);
					c.on('mousedown touchstart', function(b) {
						b.preventDefault();
						h = b.clientX;
						positionY = b.clientY;
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							e(c);
						});
						c.on('mousemove touchmove', function(d) {
							d.preventDefault();
							newPositionX = h - d.clientX;
							newPositionY = positionY - d.clientY;
							d = Math.abs(newPositionX);
							var g = Math.abs(newPositionY);
							if (a.hasOwnProperty('direction'))
								if ('string' === typeof a.direction)
									switch (a.direction) {
										case 'left':
											0 < newPositionX && 100 <= d && (f(), e(c));
											break;
										case 'right':
											0 > newPositionX && 100 <= d && (f(), e(c));
											break;
										case 'top':
											0 < newPositionY && 100 <= g && (f(), e(c));
											break;
										case 'down':
											0 > newPositionY && 100 <= g && (f(), e(c));
									}
								else throw Error('params direction must be string');
							else throw Error('must be set direction params');
						});
					});
				} else throw Error('param target element must be string');
			else throw Error('no set target element');
		},
		press: function(a) {
			b = a;
			if (a.hasOwnProperty('target'))
				if ('string' === typeof a.target) {
					var c = $(a.target);
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						f();
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							e(c);
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		longPress: function(a) {
			b = a;
			if (a.hasOwnProperty('target'))
				if ('string' === typeof a.target) {
					var c = $(a.target),
						l = 1500;
					if (a.hasOwnProperty('wait_time'))
						if ('integer' === typeof a.wait_time) l = a.wait_time;
						else throw Error('param wait time must be integer');
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						setTimeout(function() {
							f();
						}, l);
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							e(c);
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		rotate: function(a) {
			b = a;
			if (b.hasOwnProperty('target'))
				if ('string' === typeof b.target) {
					var c = $(b.target);
					c.on('mousedown touchstart', function(a) {
						a.preventDefault();
						h = a.clientX;
						positionY = a.clientY;
						if (a.touches instanceof Array && 2 < a.touches.length) {
							var d = a.touches[0].clientY;
							h = a.touches[0].clientX;
							positionY = d;
						}
						c.on('mouseup touchend', function(a) {
							a.preventDefault();
							e(c);
						});
						c.on('mousemove touchmove', function(a) {
							a.preventDefault();
							newPositionX = a.clientX;
							newPositionY = a.clientY;
							if (a.touches instanceof Array && 2 < a.touches.length) {
								var d = a.touches[0].clientY;
								newPositionX = a.touches[0].clientX;
								newPositionY = d;
							}
							a = 180 * Math.atan2(newPositionY - positionY, newPositionX - h) / Math.PI;
							20 >= a && -20 <= a
								? (f(), e(c))
								: 110 >= a && 70 <= a ? (f(), e(c)) : 90 < a && 180 > a && (f(), e(c));
						});
					});
				} else throw Error('param target must be string');
			else throw Error('no set target element');
		},
		zoom: function(a) {
			b = a;
			if (b.hasOwnProperty('target'))
				if ('string' === typeof b.target) {
					var c = $(b.target);
					if (b.hasOwnProperty('direction'))
						if ('string' === typeof b.direction) {
							var e = b.direction,
								d = [],
								g = -1;
							c.on('pointerdown', function(a) {
								d.push(a);
								2 === d.length && (g = Math.abs(d[0].clientX - d[1].clientX));
							});
							c.on('pointermove', function(a) {
								for (var b = 0; b < d.length; b++) d[b].pointerId === a.pointerId && (d[b] = a);
								2 === d.length &&
									((a = Math.abs(d[0].clientX - d[1].clientX)),
									(b = a - g),
									0 < b && 'in' === e ? (f(), k(c)) : 0 > b && 'out' === e && (f(), k(c)),
									(g = a));
							});
							c.on('pointerup', function(a) {
								for (var b = 0; b < d.length; b++)
									if (d[b].pointerId == a.pointerId) {
										d.splice(b, 1);
										break;
									}
								2 > d.length && (g = -1);
								0 == d.length && k(c);
							});
						} else throw Error('param direction must be string');
					else throw Error('param direction must be set');
				} else throw Error('param target element must be string');
			else throw Error('no set target element');
		}
	};
})();
